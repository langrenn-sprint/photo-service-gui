{% extends "open_base_new.html" %}

{% block titleheader %}
  Innstillinger
{% endblock %}

{% block headercontainer %}Innstillinger <img id=header_icon src="../static/icon_settings.png"> {% endblock %}

{% block titlemain %}
  <img id=menu_icon src="../static/icon_settings.png"> Innstillinger
{% endblock %}

{% block menuitems %}
  <li class=dropdown id=topborder>
    <a href=config?event_id={{ event_id }}&action=edit class=dropbtn>Rediger</a>
  </li>
{% endblock %}

{% block tips %}
  Her kan du se og redigere konfigurasjonsparametere for arrangementet.
{% endblock %}

{% block content %}
  <p>
    <span id="informasjon"></span>
  </p>
  <section class="row" aria-label="Event">
    {% for service_instance in service_instances %}
      <div class="col-sm-12">
        <div class="status-card" role="status" aria-live="polite">
          <h4>Service Instance: {{ service_instance.instance_name }}</h4>
          <table>
            {% set items = service_instance.items() | list %}
            {% for i in range(0, items | length, 2) %}
              <tr {% if loop.index % 2 == 0 %}bgcolor="#ddd"{% endif %}>
                <td><strong>{{ items[i][0] }}</strong></td>
                <td>{{ items[i][1] }}</td>
                {% if i + 1 < items | length %}
                  <td><strong>{{ items[i + 1][0] }}</strong></td>
                  <td>{{ items[i + 1][1] }}</td>
                {% else %}
                  <td></td>
                  <td></td>
                  {% endif %}
              </tr>
            {% endfor %}
          </table>
          {% if action == "edit" %}
            <form action=/config method=post>
              <input type="submit" class="btn btn-warning" name=delete_instance value="  Slett  ">
              <input type=hidden name="event_id" value="{{ event_id }}">
              <input type=hidden name="id" value="{{ service_instance.id }}">
            </form>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </section>
  <hr>
  <section class="row" aria-label="Event">
    <div class="col-sm-12">
      <div class="status-card" role="status" aria-live="polite">
        <h4>Config for event {{ event.name }}, {{ event.date_of_event }}</h4>
        <table>
          {% for oneconfig in event_config %}
            <tr {% if loop.index % 2 == 0 %}bgcolor="#ddd"{% endif %}>
              <td>&nbsp;{{ oneconfig.key }}&nbsp;</td>
              <td>
                {% if action == "edit" %}
                  <form action=/config method=post>
                    <input type="text" class="form-control" name="value" value="{{ oneconfig.value }}" required>
                    </td><td align="center">
                    <input type="submit" class="btn btn-success" name=update_one value="  Oppdater  ">
                    <input type=hidden name="event_id" value="{{ event_id }}">
                    <input type=hidden name="key" value="{{ oneconfig.key }}">
                  </form>
                {% else %}
                  {{ oneconfig.value }}
                  </td><td>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </table>
      </div>
    </div>
  </section>
{% endblock %}